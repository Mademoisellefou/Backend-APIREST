!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pathon=e():t.pathon=e()}(global,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";var n=r(1).path,o=r(2),i=o.mutablePreset,a=o.immutablePreset;t.exports.path=n,t.exports.mutablePreset=i,t.exports.immutablePreset=a},function(t,e,r){"use strict";function n(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),t}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var f={hasPath:function(t,e){return t.hasOwnProperty(e)},getValueByKey:function(t,e){return t[e]},mergeStateAndPayload:function(t,e){return"object"===l(t)?Object.assign(t,e):e},insertValueToStateByPath:function(t,e,r){return t[e]=r,t},deleteChild:function(t,e){return!0===Array.isArray(t)?e<0?t:(t.splice(e,1),t):(delete t[e],t)}},h=function(t){try{for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.apply(void 0,r)}catch(t){var o=new Error(t);setTimeout(function(){throw o})}},_=function(t,e){var r=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},t=t||"root",e),n=new Map,o=0,i=[];return{get:function(){return r},__setChildStateToOwnStateByPath:function(e,n){r[t]=n},__addWatchersForUpdate:function(t,e){n.set(t,e)},__freezeWatchers:function(){++o},__unfreezeWatchers:function(){if(0==--o){var t=!0,e=!1,r=void 0;try{for(var i,a=n[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=s(i.value,2),c=u[0],l=u[1],f=!0,_=!1,y=void 0;try{for(var p,d=c[Symbol.iterator]();!(f=(p=d.next()).done);f=!0){var b=p.value;h(b,l)}}catch(t){_=!0,y=t}finally{try{f||null==d.return||d.return()}finally{if(_)throw y}}}}catch(t){e=!0,r=t}finally{try{t||null==a.return||a.return()}finally{if(e)throw r}}n.clear()}},getPath:function(){return i},__catchError:function(t){throw o=0,n.clear(),t}}},y=function(){function t(e,r,n,o){a(this,t),this.__key=e,this.__updaterPreset=n,this.__parent=o,this.__ignoreSetFromChildLevel=0,this.__watchers=new Set,this.__children=new Map,this.__freezeWatchers=o.__freezeWatchers,this.__unfreezeWatchers=o.__unfreezeWatchers,this.__addWatchersForUpdate=o.__addWatchersForUpdate,this.__catchError=o.__catchError}return c(t,[{key:"__setChildStateToOwnStateByPath",value:function(t,e){if(0===this.__ignoreSetFromChildLevel){var r=this.__updaterPreset.insertValueToStateByPath(this.get(),t,e);this.__parent.__setChildStateToOwnStateByPath(this.__key,r),this.__parent.__addWatchersForUpdate(this.__watchers,r)}}}]),t}(),p=function(t){function e(){return a(this,e),n(this,o(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(e,y),c(e,[{key:"get",value:function(){return this.__updaterPreset.getValueByKey(this.__parent.get(),this.__key)}},{key:"set",value:function(t){var e;this.__freezeWatchers();try{if(0!==this.__children.size&&"object"===l(t)&&null!==t){this.__ignoreSetFromChildLevel++;var r=this.__children,n=Object.entries(t);if(r.size<n.length){var o=!0,i=!1,a=void 0;try{for(var u,c=r.entries()[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var f=s(u.value,2),h=f[0];(p=f[1]).set(t[h])}}catch(t){i=!0,a=t}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}}else for(var _=0;_<n.length;_++){var y=s(n[_],2),p=(h=y[0],y[1]),d=r.get(h);void 0!==d&&d.set(p)}this.__ignoreSetFromChildLevel--}e=this.__updaterPreset.mergeStateAndPayload(this.get(),t),this.__parent.__setChildStateToOwnStateByPath(this.__key,e)}catch(t){this.__ignoreSetFromChildLevel--,this.__catchError(t,this.getPath())}return this.__addWatchersForUpdate(this.__watchers,e),this.__unfreezeWatchers(),e}},{key:"del",value:function(t){var e;this.__freezeWatchers();try{this.__children.delete(t),e=this.__updaterPreset.deleteChild(this.get(),t),this.__parent.__setChildStateToOwnStateByPath(this.__key,e)}catch(t){this.__catchError(t)}this.__addWatchersForUpdate(this.__watchers,e),this.__unfreezeWatchers()}},{key:"batch",value:function(t){try{this.__freezeWatchers(),this.__ignoreSetFromChildLevel++,t(this),this.__ignoreSetFromChildLevel--,this.__parent.__setChildStateToOwnStateByPath(this.__key,this.get()),this.__unfreezeWatchers()}catch(t){this.__ignoreSetFromChildLevel--,this.__catchError(t)}}},{key:"getPath",value:function(){return this.__parent.getPath().concat([this.__key])}},{key:"watch",value:function(t){var e=this;return this.__watchers.add(t),function(){return e.unwatch(t)}}},{key:"unwatch",value:function(t){return this.__watchers.delete(t)}},{key:"path",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.__updaterPreset,o=this.__children;if(!0===o.has(t))return o.get(t);var i=new e(t,r,n,this);if(o.set(t,i),void 0!==r&&!1===this.__updaterPreset.hasPath(this.get(),t))try{this.__freezeWatchers(),this.__setChildStateToOwnStateByPath(t,r),this.__unfreezeWatchers()}catch(t){this.__catchError(t)}return i}}]),e}();t.exports.path=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return new p(t,e,r,_(t,e,r))}},function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={hasPath:function(t,e){return t instanceof Map||t instanceof Set?t.has(e):"object"===o(t)&&null!==t&&t.hasOwnProperty(e)},getValueByKey:function(t,e){return t instanceof Map?t.get(e):t instanceof Set?n(t)[e]:"object"===o(t)&&null!==t?t[e]:t},mergeStateAndPayload:function(t,e){return e},insertValueToStateByPath:function(t,e,r){return t instanceof Map?t.set(e,r):t instanceof Set?t.add(r):"object"===o(t)&&null!==t?(t[e]=r,t):t},deleteChild:function(t,e){return t instanceof Map?(t.delete(e),t):t instanceof Set?(t.delete(e),t):!0===Array.isArray(t)?e<0?t:(t.splice(e,1),t):(delete t[e],t)}},a={hasPath:function(t,e){return t instanceof Map||t instanceof Set?t.has(e):"object"===o(t)&&null!==t&&t.hasOwnProperty(e)},getValueByKey:function(t,e){return t instanceof Map?t.get(e):t instanceof Set?n(t)[e]:"object"===o(t)&&null!==t?t[e]:t},mergeStateAndPayload:function(t,e){return t instanceof Map?new Map(n(t).concat(n(e))):t instanceof Set?new Set(n(t).concat(n(e))):Array.isArray(t)?e:"object"===o(t)&&null!==t?Object.assign({},t,e):e},insertValueToStateByPath:function(t,e,r){if(t instanceof Map)return new Map(t).set(e,r);if(t instanceof Set){var i=n(t);return i[e]=r,new Set(i)}if(Array.isArray(t)){var a=t.slice();return a[e]=r,a}return"object"===o(t)&&null!==t?Object.assign({},t,function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},e,r)):t},deleteChild:function(t,e){if(t instanceof Map){var r=new Map(t);return r.delete(e),r}if(t instanceof Set){var o=new Set(n(t));return o.delete(e),o}if(!0===Array.isArray(t))return 0===e?t.slice(1):e<0?t:t.slice(0,+e).concat(t.slice(+e+1));t[e];return function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,[e])}};t.exports={mutablePreset:i,immutablePreset:a}}])});